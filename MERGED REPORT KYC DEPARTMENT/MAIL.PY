from email.message import EmailMessage
from email.utils import make_msgid
import mimetypes
import smtplib


s = smtplib.SMTP(host='smtp.office365.com', port=587)
s.starttls()


s.login('iotautomation@manappuram.com', 'ybjmxbfdyzkdnjtw')
msg = EmailMessage()

print("Ready for mailing")


msg['Subject'] = 'MERGING VERIFICATION NEW DASHBOARD '

msg['From'] = 'IoT<iotautomation@manappuram.com>'
msg['To']='KASHYAP G<ittesting32@manappuram.com>'
# msg['Cc']='ATHUL A<iotsupport10@manappuram.com>'
# msg['To'] ='SIJIMOL.P.S<cmkyc@manappuram.com>,HO Operation<hooperation@manappuram.com>,operation head<operationheads@manappuram.c'
# msg['To'] ='SAJITH PS<smkyc@manappuram.com>,VREESHA E P<itcoordinatorkyc@manappuram.com>'
msg['Cc'] ='MAYA T S<iotsupport7@manappuram.com>,sreelakshmi p satheesh<itprogramer20@manappuram.com>'
# #with open(r"C:\mail_crf\mail\operation_report.xlsx",'rb')  as ra:
#with open(r"C:\mail_crf\mail\operation_report.xlsx",'rb') as ra
# with open(r"C:\mail_crf\mail\operation_report.xlsx",'rb')as ra:
with open(r"D:\MYCODE\MERGED REPORT KYC DEPARTMENT\MERGING VERIFICATION NEW DASHBOARD.xlsx",'rb')as ra:
# with open(r"C:\mail_crf\mail\operation_report.xlsx",'rb') as ra:
# with open(r"C:\mail_crf\operation_report.xlsx", 'rb') as ra:
    attachment = ra.read()
msg.add_related(attachment, maintype='application', subtype='xlsx', filename='MERGING VERIFICATION NEW DASHBOARD.xlsx')

msg.add_alternative("""\

    <html>
        <body>
            <p><i>Dear Sir/Madam,</i></p>
            <p> </p>
            <p><i> Please find the attachment for CRF_ID(123721) MERGING VERIFICATION NEW DASHBOARD .Please check and verify the report.</i></p>
            <p></p>
            <p> <i>Thanks & Regards,<br>
                ( This is an autogenerated mail )<br>
        IOT <br>
            </i></p>
        </body>
    </html>
    """ ,subtype='html')
s.send_message(msg)

print("Mail sent")